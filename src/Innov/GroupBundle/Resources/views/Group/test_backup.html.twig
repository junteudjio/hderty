<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.1.1
Version: 2.0.2
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" >
    <!--<![endif]-->
    <!-- BEGIN HEAD -->
    <head>
        <meta charset="utf-8"/>
        <title>H-Derty Login</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <meta content="" name="description"/>
        <meta content="" name="author"/>
        <!-- BEGIN GLOBAL MANDATORY STYLES -->
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css"/>
        <link href="{{ asset('metronic/plugins/font-awesome/css/font-awesome.min.css') }}" rel="stylesheet" type="text/css"/>
        <link href="{{ asset('metronic/plugins/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet" type="text/css"/>
        <link href="{{ asset('metronic/plugins/uniform/css/uniform.default.css') }}" rel="stylesheet" type="text/css"/>
        <!-- END GLOBAL MANDATORY STYLES -->

        <link href="{{ asset('metronic/css/style-metronic.css') }}" rel="stylesheet" type="text/css" />
        <link href="{{ asset('metronic/css/style.css') }}" rel="stylesheet" type="text/css" />
        <link href="{{ asset('metronic/css/style-responsive.css') }}" rel="stylesheet" type="text/css" />
        <link href="{{ asset('metronic/css/plugins.css') }}" rel="stylesheet" type="text/css" />
        <link href="{{ asset('metronic/css/themes/default.css') }}" rel="stylesheet" type="text/css" id="style_color" />
        <link href="{{ asset('metronic/css/custom.css') }}" rel="stylesheet" type="text/css" />


        <!-- BEGIN PAGE LEVEL STYLES -->
        <link rel="stylesheet" type="text/css" href="{{ asset('metronic/plugins/select2/select2.css') }}"/>
        <link rel="stylesheet" type="text/css" href="{{ asset('metronic/plugins/select2/select2-metronic.css') }}"/>
        <!-- END PAGE LEVEL SCRIPTS -->
        <!-- BEGIN THEME STYLES -->
        <link href="{{ asset('metronic/plugins/jquery-file-upload/blueimp-gallery/blueimp-gallery.min.css') }}" rel="stylesheet" />
        <link href="{{ asset('metronic/plugins/jquery-file-upload/css/jquery.fileupload.css') }}" rel="stylesheet" />
        <link href="{{ asset('metronic/plugins/jquery-file-upload/css/jquery.fileupload-ui.css') }}" rel="stylesheet" />
        <!-- END THEME STYLES -->
        <link rel="shortcut icon" href="favicon.ico"/>
    </head>
    <!-- END HEAD -->
    <!-- BEGIN BODY -->
    <body>
        <div class="page-content-wrapper">
            <div class="page-content" style="background-color:ghostwhite">
                <div class="row">

                    <div class="col-md-12">

                        <h3 class="page-title">{{ 'innov.upload_form.header'|trans }}</h3>

                        <br>

                        <form id="fileupload" action="" method="POST" enctype="multipart/form-data">
                            <div class="form-group">
                              
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <i class="fa fa-file-text-o"></i>
                                    </span>


                    {{ form_widget(form.titre , { 'attr': { 'placeholder': 'innov.upload_form.document_titre'|trans , 'class':'form-control'} }) }}
                                </div>
                            </div>
                            <div class="form-group">
                                
                                <div class="input-group">
                                    <span class="input-group-addon">
                                        <i class="fa fa-tags"></i>
                                    </span>

                    {{ form_widget(form.tags , { 'attr': { 'placeholder': 'innov.upload_form.document_tag'|trans, 'id': 'tags', 'type': 'hidden', 'class': 'form-control select2'} }) }}
                                </div>
                            </div>
                            <div class="row fileupload-buttonbar">
                                <div class="col-lg-7">
                                    <!-- The fileinput-button span is used to style the file input field as button -->
                                    <span class="btn green fileinput-button">
                                        <i class="fa fa-plus"></i>
                                        <span>
                                            {{ 'innov.upload_form.button_add'|trans }}
                                        </span>
                                        <input type="file" name="files[]" multiple="">
                                    </span>
                                    <button id="send" type="submit" class="btn blue start">
                                        <i class="fa fa-upload"></i>
                                        <span>
                                             {{ 'innov.upload_form.button_submit'|trans }}
                                        </span>
                                    </button>
                                    <button type="reset" class="btn warning cancel">
                                        <i class="fa fa-ban-circle"></i>
                                        <span>
                                             {{ 'innov.upload_form.button_annuler'|trans }}
                                        </span>
                                    </button>
                                    <button type="button" class="btn red delete">
                                        <i class="fa fa-trash"></i>
                                        <span>
                                             {{ 'innov.upload_form.button_supprimer'|trans }}
                                        </span>
                                    </button>
                                    <input type="checkbox" class="toggle">
                                    <!-- The global file processing state -->
                                    <span class="fileupload-process">
                                    </span>
                                </div>
                                <!-- The global progress information -->
                                <div class="col-lg-5 fileupload-progress fade">
                                    <!-- The global progress bar -->
                                    <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                        <div class="progress-bar progress-bar-success" style="width:0%;">
                                        </div>
                                    </div>
                                    <!-- The extended global progress information -->
                                    <div class="progress-extended">
                                        &nbsp;
                                    </div>
                                </div>
                            </div>
                            <!-- The table listing the files available for upload/download -->
                            <table role="presentation" class="table table-striped clearfix">
                                <tbody class="files">
                                </tbody>
                            </table>
                     <div class="form-group">

										
									      
                    {{ form_widget(form.description , { 'attr': { 'placeholder': 'innov.upload_form.document_description'|trans , 'class':'form-control' } }) }}
                                                                                </div> 
                            <br><br><br><br><br><br><br><br><br><br><br><br><br>
                    {{  form_rest(form) }}
                        </form>
                    </div>
                </div>
            </div>
        </div>




            {% raw %}
        <script id="template-upload" type="text/x-tmpl">
            {% for (var i=0, file; file=o.files[i]; i++) { %}
            <tr class="template-upload fade">
            <td>
            <span class="preview"></span>
            </td>
            <td>
            <p class="name">{%=file.name%}</p>
            {% if (file.error) { %}
            <div><span class="label label-danger">Error</span> {%=file.error%}</div>
            {% } %}
            </td>
            <td>
            <p class="size">{%=o.formatFileSize(file.size)%}</p>

            </td>
            <td>
            {% if (!i) { %}
            <button class="btn red cancel btn-sm">
            <i class="fa fa-ban"></i>
            <span>Cancel</span>
            </button>
            {% } %}
            </td>
            </tr>
            {% } %}
        </script>
               {% endraw %}
        <!-- The template to display files available for download -->
            {% raw %}
        <script id="template-download" type="text/x-tmpl">
            {% for (var i=0, file; file=o.files[i]; i++) { %}
            <tr class="template-download fade">
            <td>
            <span class="preview">
            {% if (file.thumbnailUrl) { %}
            <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" data-gallery><img src="{%=file.thumbnailUrl%}"></a>
            {% } %}
            </span>
            </td>
            <td>
            <p class="name">
            {% if (file.url) { %}
            <a href="{%=file.url%}" title="{%=file.name%}" download="{%=file.name%}" {%=file.thumbnailUrl?'data-gallery':''%}>{%=file.name%}</a>
            {% } else { %}
            <span>{%=file.name%}</span>
            {% } %}
            </p>
            {% if (file.error) { %}
            <div><span class="label label-danger">Error</span> {%=file.error%}</div>
            {% } %}
            </td>
            <td>
            <span class="size">{%=o.formatFileSize(file.size)%}</span>
            </td>
            <td>
            {% if (file.deleteUrl) { %}
            <button class="btn red delete btn-sm" data-type="{%=file.deleteType%}" data-url="{%=file.deleteUrl%}"{% if (file.deleteWithCredentials) { %} data-xhr-fields='{"withCredentials":true}'{% } %}>
            <i class="fa fa-trash-o"></i>
            <span>Delete</span>
            </button>
            <input type="checkbox" name="delete" value="1" class="toggle">
            {% } else { %}
            <button class="btn yellow cancel btn-sm">
            <i class="fa fa-ban"></i>
            <span>Cancel</span>
            </button>
            {% } %}
            </td>
            </tr>
            {% } %}
                    {% endraw %}
        </script>
        <!-- BEGIN CORE PLUGINS -->
        <script src="{{ asset('metronic/plugins/jquery-1.10.2.min.js') }}" type="text/javascript"></script>
        <script src="{{ asset('metronic/plugins/jquery-migrate-1.2.1.min.js') }}" type="text/javascript"></script>
        <script src="{{ asset('metronic/plugins/bootstrap/js/bootstrap.min.js') }}" type="text/javascript"></script>

        <!--[if lt IE 9]>
            <script src="{{ asset('metronic/plugins/respond.min.js') }}"></script>
            <script src="{{ asset('metronic/plugins/excanvas.min.js') }}"></script> 
            <![endif]-->

        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js') }}"></script>
        <!-- The Templates plugin is included to render the upload/download listings -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/vendor/tmpl.min.js') }}"></script>
        <!-- The Load Image plugin is included for the preview images and image resizing functionality -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/vendor/load-image.min.js') }}"></script>
        <!-- The Canvas to Blob plugin is included for image resizing functionality -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/vendor/canvas-to-blob.min.js') }}"></script>
        <!-- blueimp Gallery script -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/blueimp-gallery/jquery.blueimp-gallery.min.js') }}"></script>
        <!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.iframe-transport.js') }}"></script>
        <!-- The basic File Upload plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload.js') }}"></script>
        <!-- The File Upload processing plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-process.js') }}"></script>
        <!-- The File Upload image preview & resize plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-image.js') }}"></script>
        <!-- The File Upload audio preview plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-audio.js') }}"></script>
        <!-- The File Upload video preview plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-video.js') }}"></script>
        <!-- The File Upload validation plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-validate.js') }}"></script>
        <!-- The File Upload user interface plugin -->
        <script src="{{ asset('metronic/plugins/jquery-file-upload/js/jquery.fileupload-ui.js') }}"></script>
        <!-- The main application script -->
        <!-- The XDomainRequest Transport is included for cross-domain file deletion for IE 8 and IE 9 -->
        <!--[if (gte IE 8)&(lt IE 10)]>
            <script src="{{ asset('metronic/plugins/jquery-file-upload/js/cors/jquery.xdr-transport.js') }}"></script>
            <![endif]-->
        <!-- END:File Upload Plugin JS files-->

        <script src="{{ asset('metronic/plugins/fancybox/source/jquery.fancybox.pack.js') }}"></script>
        <script src="{{ asset('metronic/plugins/fancybox/source/jquery.fancybox.js') }}"></script>

        <script src="{{ asset('metronic/scripts/custom/form-fileupload.js') }}"></script>

        <!-- plugins pour le multi select -->
        <script type="text/javascript" src="{{ asset('metronic/plugins/bootstrap-select/bootstrap-select.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('metronic/plugins/select2/select2.min.js') }}"></script>
        <script type="text/javascript" src="{{ asset('metronic/plugins/jquery-multi-select/js/jquery.multi-select.js') }}"></script>
        <!-- fin des plugins du multi upload -->

        <!-- BEGIN PAGE LEVEL SCRIPTS -->

        <!-- END PAGE LEVEL SCRIPTS -->

        <script>
jQuery(document).ready(function() {

    FormFileUpload.init(); // celui là c'est pour l'upload

    // début lignes lignes de code  pour le multi-upload
    //  ComponentsDropdowns.init();
    //ComponentsFormTools.init();

    $('#form_tags').select2({
        tags: true,
        createSearchChoice: function(term, data) {
            if ($(data).filter(function() {
                return this.text.toLocaleLowerCase().localeCompare(term.toLocaleLowerCase()) === 0;
            }).length === 0) {
                return {
                    id: term,
                    text: term
                };
            }
        },
        placeholder: "Select...",
        //minimumInputLength: 2,
        //tokenSeparators: [","," "],
        ajax: {
            url: "{{ path('InnovGroup_ajaxTags')}}",
            dataType: 'json',
            quietMillis: 100,
            data: function(term, page) {
                return {
                    term: term //search term
                };
            },
            results: function(data, page) {
                return {
                    results: data
                };
            }

        },
        initSelection: function(element, callback) {
            return $.getJSON(null, null, function(data) {

                return callback(data);

            });
        }
    });




    // fin lignes de codes pour le multi-upoad

    $('#send').click(function(e) {

        var allData = [];
        $('#fileupload').find('.template-upload').each(function() {
            var is_unique = true;
            var data = $(this).data('data');
            for (i = 0; i < allData.length; ++i) {
                if (allData[i] == data) {
                    is_unique = false;
                    break;
                }
            }
            ;
            if (is_unique) {
                allData.push(data);
            }
        });
        var allFiles = [];
        $.each(allData, function() {
            allFiles = allFiles.concat(this.files);
        });
        var jqXHR = $('#fileupload').fileupload('send', {files: allFiles})
                .success(function(result, textStatus, jqXHR) {
                    parent.jQuery.fancybox.close();
                    $('.files').html('');


                })
                .error(function(jqXHR, textStatus, errorThrown) {
                    console.log('e');
                   if(textStatus =='parsererror')
				   {
					 parent.jQuery.fancybox.close();
                    $('.files').html('');
				   }
                    console.log(textStatus);
                    
                })
                .complete(function(result, textStatus, jqXHR) {
                    console.log('c');
                    console.log(result);
                });
        e.preventDefault();
    });




});

        </script>        

    </body>
    <!-- END BODY -->
</html>
